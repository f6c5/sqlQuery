CREATE DATABASE MUSTERİ_DB;

USE MUSTERİ_DB;

CREATE TABLE MUSTERI( 
ID INT IDENTITY(1,1) PRIMARY KEY,      
AD VARCHAR(20),                        
SOYAD VARCHAR(20),                     
EMAIL VARCHAR(20)                      
);

CREATE TABLE SIPARIS(                             
ID INT IDENTITY(1,1) PRIMARY KEY,                 
SIPARIS_TARIHI DATE,                              
TUTAR DECIMAL(5,2),                               
MUSTERI_ID INT                                    
FOREIGN KEY(MUSTERI_ID) REFERENCES MUSTERI(ID)   
);

INSERT INTO MUSTERI(AD,SOYAD,EMAIL)            
VALUES ('UFUK','KUBILAY','UFUK@KUBILAY.COM'),
       ('ALPER','DILEKTASLI','ALPER@DILEKTASLI'),
	   ('ONUR','KARDES','ONUR@KARDES.COM'),
	   ('DENIZ','KAYNAK','DENIZ@KAYNAK.COM'),
	   ('ELIF','INCE','ELIF@INCE.COM');

SELECT * FROM MUSTERI;   
INSERT INTO SIPARIS(SIPARIS_TARIHI,TUTAR,MUSTERI_ID)  
VALUES('2021/07/08','99.99',1),
      ('2021/07/09','120.01',1),
	  ('2021/03/04','24.87',2),
	  ('2021/06/01','700',2),
	  ('2021/05/26','65.90',5);

SELECT * FROM SIPARIS;   

SELECT AD,SOYAD,SIPARIS_TARIHI,TUTAR FROM MUSTERI JOIN SIPARIS ON MUSTERI.ID=SIPARIS.MUSTERI_ID;

SELECT AD, SOYAD,SUM(TUTAR) AS TOPLAM_HARCAMA FROM MUSTERI JOIN SIPARIS ON MUSTERI.ID=SIPARIS.MUSTERI_ID GROUP BY MUSTERI.AD,MUSTERI.SOYAD ORDER BY TOPLAM_HARCAMA DESC;

SELECT * FROM MUSTERI LEFT JOIN SIPARIS ON MUSTERI.ID=SIPARIS.MUSTERI_ID;

SELECT AD,SOYAD,ISNULL(SUM(TUTAR),0) AS TOPLAM_HARCAMA FROM MUSTERI LEFT JOIN SIPARIS ON MUSTERI.ID=SIPARIS.MUSTERI_ID GROUP BY MUSTERI.AD,MUSTERI.SOYAD ORDER BY TOPLAM_HARCAMA DESC; 

SELECT ISNULL(AD,'KAYIP') AS IAD,ISNULL(SOYAD,'VERI') AS SAD,TUTAR  FROM MUSTERI RIGHT JOIN SIPARIS ON MUSTERI.ID=SIPARIS.MUSTERI_ID

CREATE TABLE FAKE(                  
ID INT IDENTITY(1,1) PRIMARY KEY,   
AD VARCHAR(20),                     
SOYAD VARCHAR(20),                  
);

INSERT INTO FAKE(AD,SOYAD)    
VALUES ('UFUK','KUBILAY'),
       ('ALPER','DILEKTASLI'),
	   ('ONUR','KARDES');

SELECT AD,SOYAD FROM MUSTERI
UNION
SELECT AD,SOYAD FROM FAKE;
